# GPU 的存储

GPU 的存储结构包括了寄存器，本地内存，共享内存，常量内存，纹理内存，全局内存，缓存

## 寄存器

最快的存储结构，寄存器为每个线程私有，生命周期和线程是一样的，随着线程的释放而释放。
编写代码时应该使用更少的寄存器，这么每个 SM 能容纳更多的 block

如果寄存器放不下，会放到本地内存上，即寄存器溢出(register spilling)

## 本地内存

也是每个线程私有，寄存器不够时放在这，此外，编译器无法确定值的数组和占用较多的内存变量也会放在这。本地内部不在片内，通常是全局内存的一部分，所以比较慢。

## 共享内存

一个线程块中的线程共享，生命周期伴随整个 Block，由于其在 GPU 片内所以访问速度比较快。
“\_\_shared__” 修饰的变量存储在共享内存中。通常用于线程块内的线程通信，获取 shared memory 数据前需要先同步。

## 常量内存

对所有的线程可见，每一个 SM 中都有 constant cache，用 “\_\_constant__” 修饰的变量保存在这一部分内存，只读不写。

## 全局内存

生命周期为整个 GPU 线程。 ”\_\_device__“ 修饰的变量在全局内存中，cudaMalloc 分配的内存就是在全局内存中的。


## 缓存

L1 每一个 SM 都有自己的 L1 cache，所有的 SM 共享 L2 cache。
L1 和 L2 cache 都是用来缓存 local 和 global memory 的。
不同架构的 GPU 缓存设计不同。
